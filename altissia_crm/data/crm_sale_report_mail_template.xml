<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="mail_template_crm_sale_report_mail" model="mail.template">
            <field name="name">CRM sales report</field>
            <field name="subject">${ctx['subject']|safe}</field>
            <field name="email_from">${user.email}</field>
            <field name="email_to">${ctx['email_to']|safe}</field>
            <field name="lang">${user.lang}</field>
            <field name="model_id" ref="altissia_crm.model_crm_lead"/>
            <field name="auto_delete" eval="False"/>
            <field name="body_html"><![CDATA[<html>
                        <link href="https://fonts.googleapis.com/css?family=Poppins|Roboto+Slab&display=swap" rel="stylesheet">
                        <div style="font-family: 'Roboto Slab'; font-size: 12px; color: rgb(34, 34, 34);">
                        <div style="font-family: Poppins; font-size: 24px; font-weight: 700;color: #3d5285;">${ctx['subject']|safe}</div>
                        <div style="font-family: Poppins; font-size: 24px; font-weight: 700;color: #3d5285;">${ctx['sale_team']|safe}</div>
                        <div style="font-family: Poppins; font-size: 24px; font-weight: 700;color: #3d5285;">PAST WEEK</div>

                        % if ctx.get('count_last_7_days_lead'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">1. NEW LEADS (# ${ctx['count_last_7_days_lead']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">1. NEW LEADS </div>
                        % endif
                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('last_7_days_lead'):
                                % for lead in ctx['last_7_days_lead']:
                                    <li>${lead[0]} - ${lead[1]} -  ${lead[2]}</li>
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>

                        % if ctx.get('count_last_7_days_meeting_opps'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">2. MEETINGS OBTAINED (# ${ctx['count_last_7_days_meeting_opps']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">2. MEETINGS OBTAINED </div>
                        % endif

                        % if ctx.get('count_last_7_days_meeting_new_opp'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #51679c;">With new opportunities (# ${ctx['count_last_7_days_meeting_new_opp']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #51679c;">With new opportunities</div>
                        % endif

                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('last_7_days_meeting_new_opp'):
                                % for meeting in ctx['last_7_days_meeting_new_opp']:
                                    % if (meeting[2] != ' _ '):
                                        <li> ${meeting[0]} - ${meeting[1]} -  ${meeting[2]} ${meeting[3]}</li>
                                    %else:
                                        <li> ${meeting[0]} - ${meeting[1]}</li>
                                    % endif
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>

                        % if ctx.get('count_last_7_days_meeting_not_new_opp'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #51679c;">With existing opportunities (# ${ctx['count_last_7_days_meeting_not_new_opp']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #51679c;">With existing opportunities </div>
                        % endif

                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('last_7_days_meeting_not_new_opp'):
                                % for meeting in ctx['last_7_days_meeting_not_new_opp']:
                                    % if (meeting[2] != ' _ '):
                                        <li> ${meeting[0]} - ${meeting[1]} - ${meeting[2]} ${meeting[3]}</li>
                                    %else:
                                        <li> ${meeting[0]} - ${meeting[1]}</li>
                                    % endif
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>

                        % if ctx.get('count_last_7_days_meeting'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">3. MEETINGS ATTENDED (# ${ctx['count_last_7_days_meeting']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">3. MEETINGS ATTENDED </div>
                        % endif

                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('last_7_days_meeting'):
                                % for meeting in ctx['last_7_days_meeting']:
                                    % if (meeting[3] != ' _ '):
                                        <li> ${meeting[0]} - ${meeting[1]} - ${meeting[2]} - ${meeting[3]} ${meeting[4]}</li>
                                    %else:
                                        <li> ${meeting[0]} - ${meeting[1]} - ${meeting[2]}</li>
                                    % endif
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>

                        % if ctx.get('count_last_7_days_prop_lead'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">4. PROPOSALS SENT (# ${ctx['count_last_7_days_prop_lead']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">4. PROPOSALS SENT</div>
                        % endif

                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('last_7_days_prop_lead'):
                                % for prop_lead in ctx['last_7_days_prop_lead']:
                                    % if (prop_lead[2] != ' _ '):
                                        <li> ${prop_lead[0]} - ${prop_lead[1]} -  ${prop_lead[2]} ${prop_lead[3]}</li>
                                    %else:
                                        <li> ${prop_lead[0]} - ${prop_lead[1]} -  ${prop_lead[2]}</li>
                                    % endif
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>

                        % if ctx.get('count_last_7_days_invoices'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">5. INVOICES (# ${ctx['count_last_7_days_invoices']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">5. INVOICES </div>
                        % endif

                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('last_7_days_invoices'):
                                % for inv in ctx['last_7_days_invoices']:
                                    % if (inv[2] != ' _ '):
                                        <li> ${inv[0]} - ${inv[1]} -  ${inv[2]} ${inv[3]}</li>
                                    %else:
                                        <li> ${inv[0]} - ${inv[1]} -  ${inv[2]}</li>
                                    % endif
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>

                        <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #51679c;">Coming week</div>

                        % if ctx.get('count_next_7_days_meeting'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">1. MEETINGS PLANNED (# ${ctx['count_next_7_days_meeting']})</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">1. MEETINGS PLANNED</div>
                        % endif

                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('next_7_days_meeting'):
                                % for meeting in ctx['next_7_days_meeting']:
                                     % if (meeting[3] != ' _ '):
                                        <li> ${meeting[0]} - ${meeting[1]} - ${meeting[2]} - ${meeting[3]} ${meeting[4]}</li>
                                    %else:
                                        <li> ${meeting[0]} - ${meeting[1]} - ${meeting[2]}</li>
                                    % endif
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>
                        % if ctx.get('count_next_7_days_tasks'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">2. TASKS PLANNED (# ${ctx['count_next_7_days_tasks']} )</div>
                        % else:
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">2. TASKS PLANNED</div>
                        % endif
                        <div style="font-size: 15px;">
                        <ul>
                            % if ctx.get('next_7_days_tasks'):
                                % for task in ctx['next_7_days_tasks']:
                                    % if (task[2] != ' _ '):
                                        <li> ${task[0]} - ${task[1]} -  ${task[2]} ${task[3]} -  ${task[4]}</li>
                                    %else:
                                        <li> ${task[0]} - ${task[1]} -  ${task[2]} -  ${task[4]}</li>
                                    % endif
                                % endfor
                            % else:
                                <li></li>
                            % endif
                        </ul>
                        </div>


                </html>
            ]]></field>
        </record>

    </data>
</odoo>
