<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="mail_template_crm_sale_report_mail" model="mail.template">
            <field name="name">CRM sales report</field>
            <field name="subject">${ctx['subject']|safe}</field>
            <field name="email_from">${user.email}</field>
            <field name="email_to">${ctx['email_to']|safe}</field>
            <field name="lang">${user.lang}</field>
            <field name="model_id" ref="altissia_crm.model_crm_lead"/>
            <field name="auto_delete" eval="True"/>
            <field name="body_html"><![CDATA[<html>
                       
                        <link href="https://fonts.googleapis.com/css?family=Poppins|Roboto+Slab&display=swap" rel="stylesheet">
                        <div style="font-family: 'Roboto Slab'; font-size: 12px; color: rgb(34, 34, 34);">
                        <br/>
                        <div style="font-family: Poppins; font-size: 24px; font-weight: 700;color: #3d5285;">${ctx['subject']|safe}</div>
                        % if ctx.get('last_7_days_lead'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">NEW LEADS</div>
                            <div style="font-size: 15px;">
                            <ul>
                                <!--<li> [Tous les leads créer dans les 7 derniers jours et assignés à la personne]</li>-->
                                % for lead in ctx['last_7_days_lead']:
                                    <!--<li> [Date] : [Client] - [Nom du lead] </li>-->
                                    <li>${lead[0]} : ${lead[1]} - ${lead[2]}</li>
                                % endfor
                            </ul>
                            </div>
                        % endif
                        % if ctx.get('last_7_days_invoices'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">INVOICES</div>
                            <div style="font-size: 15px;">
                            <ul>
                                <!--<li> [Toutes les factures crées par l'utilisateur dans les 7 derniers jours]</li>-->
                                % for inv in ctx['last_7_days_invoices']:
                                    <!--<li> [Date] : [Client] - [Montant HTVA]</li>-->
                                    <li> ${inv[0]} : ${inv[1]} - ${inv[2]}</li>
                                % endfor
                            </ul>
                            </div>
                        % endif
                        % if ctx.get('next_7_days_tasks'):
                            <div style="font-family: Poppins; font-size: 20px; font-weight: 700;color: #c1d72f;">TASKS FOR NEXT 7 DAYS</div>
                            <div style="font-size: 15px;">
                            <ul>
                                <!--<li> [Toutes les tâches prévues dans les 7 prochains jours comme pour le mail]</li>-->
                                % for task in ctx['next_7_days_tasks']:
                                    <!--<li> [Date] : [Client] - [Titre de l'activité] </li>-->
                                    <li> ${task[0]} : ${task[1]} - ${task[2]}</li>
                                % endfor
                            </ul>
                            </div>
                        % endif
                </html>
            ]]></field>
        </record>

    </data>
</odoo>
